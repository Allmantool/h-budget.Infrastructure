USE master;
GO

IF EXISTS(SELECT * FROM sys.databases WITH (NOLOCK) WHERE name LIKE N'%HomeBudget%')
BEGIN
	DECLARE @UsdRates_2020 TABLE (
		[CurrencyId] INT NOT NULL,
		[Name] NVARCHAR(100) NOT NULL,
		[Abbreviation] NVARCHAR(3) NULL,
		[Scale] INT NOT NULL,
		[OfficialRate] FLOAT NOT NULL,
		[RatePerUnit] FLOAT NOT NULL,
		[UpdateDate] DATE NOT NULL
	);

	INSERT INTO @UsdRates_2020
            ([CurrencyId], [Name], [Abbreviation], [Scale], [OfficialRate], [RatePerUnit], [UpdateDate])
         VALUES
            (431, N'Доллар США', 'USD', 1, 2.1085, 2.1085, '2020-01-01'),
			(431, N'Доллар США', 'USD', 1, 2.1085, 2.1085, '2020-01-02'),
			(431, N'Доллар США', 'USD', 1, 2.1085, 2.1085, '2020-01-03'),
			(431, N'Доллар США', 'USD', 1, 2.1098, 2.1098, '2020-01-04'),
			(431, N'Доллар США', 'USD', 1, 2.1098, 2.1098, '2020-01-05'),
			(431, N'Доллар США', 'USD', 1, 2.1098, 2.1098, '2020-01-06'),
			(431, N'Доллар США', 'USD', 1, 2.1098, 2.1098, '2020-01-07'),
			(431, N'Доллар США', 'USD', 1, 2.1098, 2.1098, '2020-01-08'),
			(431, N'Доллар США', 'USD', 1, 2.1138, 2.1138, '2020-01-09'),
			(431, N'Доллар США', 'USD', 1, 2.1159, 2.1159, '2020-01-10'),
			(431, N'Доллар США', 'USD', 1, 2.1193, 2.1193, '2020-01-11'),
			(431, N'Доллар США', 'USD', 1, 2.1193, 2.1193, '2020-01-12'),
			(431, N'Доллар США', 'USD', 1, 2.1193, 2.1193, '2020-01-13'),
			(431, N'Доллар США', 'USD', 1, 2.1128, 2.1128, '2020-01-14'),
			(431, N'Доллар США', 'USD', 1, 2.1203, 2.1203, '2020-01-15'),
			(431, N'Доллар США', 'USD', 1, 2.1248, 2.1248, '2020-01-16'),
			(431, N'Доллар США', 'USD', 1, 2.1247, 2.1247, '2020-01-17'),
			(431, N'Доллар США', 'USD', 1, 2.1228, 2.1228, '2020-01-18'),
			(431, N'Доллар США', 'USD', 1, 2.1228, 2.1228, '2020-01-19'),
			(431, N'Доллар США', 'USD', 1, 2.1228, 2.1228, '2020-01-20'),
			(431, N'Доллар США', 'USD', 1, 2.1205, 2.1205, '2020-01-21'),
			(431, N'Доллар США', 'USD', 1, 2.1195, 2.1195, '2020-01-22'),
			(431, N'Доллар США', 'USD', 1, 2.1156, 2.1156, '2020-01-23'),
			(431, N'Доллар США', 'USD', 1, 2.1137, 2.1137, '2020-01-24'),
			(431, N'Доллар США', 'USD', 1, 2.113, 2.113, '2020-01-25'),
			(431, N'Доллар США', 'USD', 1, 2.113, 2.113, '2020-01-26'),
			(431, N'Доллар США', 'USD', 1, 2.113, 2.113, '2020-01-27'),
			(431, N'Доллар США', 'USD', 1, 2.1201, 2.1201, '2020-01-28'),
			(431, N'Доллар США', 'USD', 1, 2.1283, 2.1283, '2020-01-29'),
			(431, N'Доллар США', 'USD', 1, 2.1283, 2.1283, '2020-01-30'),
			(431, N'Доллар США', 'USD', 1, 2.1377, 2.1377, '2020-01-31'),
			(431, N'Доллар США', 'USD', 1, 2.138, 2.138, '2020-02-01'),
			(431, N'Доллар США', 'USD', 1, 2.138, 2.138, '2020-02-02'),
			(431, N'Доллар США', 'USD', 1, 2.138, 2.138, '2020-02-03'),
			(431, N'Доллар США', 'USD', 1, 2.1483, 2.1483, '2020-02-04'),
			(431, N'Доллар США', 'USD', 1, 2.148, 2.148, '2020-02-05'),
			(431, N'Доллар США', 'USD', 1, 2.154, 2.154, '2020-02-06'),
			(431, N'Доллар США', 'USD', 1, 2.1615, 2.1615, '2020-02-07'),
			(431, N'Доллар США', 'USD', 1, 2.1762, 2.1762, '2020-02-08'),
			(431, N'Доллар США', 'USD', 1, 2.1762, 2.1762, '2020-02-09'),
			(431, N'Доллар США', 'USD', 1, 2.1762, 2.1762, '2020-02-10'),
			(431, N'Доллар США', 'USD', 1, 2.1847, 2.1847, '2020-02-11'),
			(431, N'Доллар США', 'USD', 1, 2.1924, 2.1924, '2020-02-12'),
			(431, N'Доллар США', 'USD', 1, 2.1919, 2.1919, '2020-02-13'),
			(431, N'Доллар США', 'USD', 1, 2.2001, 2.2001, '2020-02-14'),
			(431, N'Доллар США', 'USD', 1, 2.1986, 2.1986, '2020-02-15'),
			(431, N'Доллар США', 'USD', 1, 2.1986, 2.1986, '2020-02-16'),
			(431, N'Доллар США', 'USD', 1, 2.1986, 2.1986, '2020-02-17'),
			(431, N'Доллар США', 'USD', 1, 2.1944, 2.1944, '2020-02-18'),
			(431, N'Доллар США', 'USD', 1, 2.203, 2.203, '2020-02-19'),
			(431, N'Доллар США', 'USD', 1, 2.204, 2.204, '2020-02-20'),
			(431, N'Доллар США', 'USD', 1, 2.2048, 2.2048, '2020-02-21'),
			(431, N'Доллар США', 'USD', 1, 2.212, 2.212, '2020-02-22'),
			(431, N'Доллар США', 'USD', 1, 2.212, 2.212, '2020-02-23'),
			(431, N'Доллар США', 'USD', 1, 2.212, 2.212, '2020-02-24'),
			(431, N'Доллар США', 'USD', 1, 2.2246, 2.2246, '2020-02-25'),
			(431, N'Доллар США', 'USD', 1, 2.2268, 2.2268, '2020-02-26'),
			(431, N'Доллар США', 'USD', 1, 2.2378, 2.2378, '2020-02-27'),
			(431, N'Доллар США', 'USD', 1, 2.234, 2.234, '2020-02-28'),
			(431, N'Доллар США', 'USD', 1, 2.2391, 2.2391, '2020-02-29'),
			(431, N'Доллар США', 'USD', 1, 2.2391, 2.2391, '2020-03-01'),
			(431, N'Доллар США', 'USD', 1, 2.2391, 2.2391, '2020-03-02'),
			(431, N'Доллар США', 'USD', 1, 2.2342, 2.2342, '2020-03-03'),
			(431, N'Доллар США', 'USD', 1, 2.2353, 2.2353, '2020-03-04'),
			(431, N'Доллар США', 'USD', 1, 2.2311, 2.2311, '2020-03-05'),
			(431, N'Доллар США', 'USD', 1, 2.2357, 2.2357, '2020-03-06'),
			(431, N'Доллар США', 'USD', 1, 2.2396, 2.2396, '2020-03-07'),
			(431, N'Доллар США', 'USD', 1, 2.2396, 2.2396, '2020-03-08'),
			(431, N'Доллар США', 'USD', 1, 2.2396, 2.2396, '2020-03-09'),
			(431, N'Доллар США', 'USD', 1, 2.3518, 2.3518, '2020-03-10'),
			(431, N'Доллар США', 'USD', 1, 2.3208, 2.3208, '2020-03-11'),
			(431, N'Доллар США', 'USD', 1, 2.3141, 2.3141, '2020-03-12'),
			(431, N'Доллар США', 'USD', 1, 2.3474, 2.3474, '2020-03-13'),
			(431, N'Доллар США', 'USD', 1, 2.3402, 2.3402, '2020-03-14'),
			(431, N'Доллар США', 'USD', 1, 2.3402, 2.3402, '2020-03-15'),
			(431, N'Доллар США', 'USD', 1, 2.3402, 2.3402, '2020-03-16'),
			(431, N'Доллар США', 'USD', 1, 2.3636, 2.3636, '2020-03-17'),
			(431, N'Доллар США', 'USD', 1, 2.3673, 2.3673, '2020-03-18'),
			(431, N'Доллар США', 'USD', 1, 2.4413, 2.4413, '2020-03-19'),
			(431, N'Доллар США', 'USD', 1, 2.5414, 2.5414, '2020-03-20'),
			(431, N'Доллар США', 'USD', 1, 2.5591, 2.5591, '2020-03-21'),
			(431, N'Доллар США', 'USD', 1, 2.5591, 2.5591, '2020-03-22'),
			(431, N'Доллар США', 'USD', 1, 2.5591, 2.5591, '2020-03-23'),
			(431, N'Доллар США', 'USD', 1, 2.6396, 2.6396, '2020-03-24'),
			(431, N'Доллар США', 'USD', 1, 2.6, 2.6, '2020-03-25'),
			(431, N'Доллар США', 'USD', 1, 2.5789, 2.5789, '2020-03-26'),
			(431, N'Доллар США', 'USD', 1, 2.59, 2.59, '2020-03-27'),
			(431, N'Доллар США', 'USD', 1, 2.5754, 2.5754, '2020-03-28'),
			(431, N'Доллар США', 'USD', 1, 2.5754, 2.5754, '2020-03-29'),
			(431, N'Доллар США', 'USD', 1, 2.5754, 2.5754, '2020-03-30'),
			(431, N'Доллар США', 'USD', 1, 2.6023, 2.6023, '2020-03-31'),
			(431, N'Доллар США', 'USD', 1, 2.5856, 2.5856, '2020-04-01'),
			(431, N'Доллар США', 'USD', 1, 2.5973, 2.5973, '2020-04-02'),
			(431, N'Доллар США', 'USD', 1, 2.5893, 2.5893, '2020-04-03'),
			(431, N'Доллар США', 'USD', 1, 2.5846, 2.5846, '2020-04-04'),
			(431, N'Доллар США', 'USD', 1, 2.5722, 2.5722, '2020-04-05'),
			(431, N'Доллар США', 'USD', 1, 2.5722, 2.5722, '2020-04-06'),
			(431, N'Доллар США', 'USD', 1, 2.5708, 2.5708, '2020-04-07'),
			(431, N'Доллар США', 'USD', 1, 2.552, 2.552, '2020-04-08'),
			(431, N'Доллар США', 'USD', 1, 2.5512, 2.5512, '2020-04-09'),
			(431, N'Доллар США', 'USD', 1, 2.516, 2.516, '2020-04-10'),
			(431, N'Доллар США', 'USD', 1, 2.4752, 2.4752, '2020-04-11'),
			(431, N'Доллар США', 'USD', 1, 2.4752, 2.4752, '2020-04-12'),
			(431, N'Доллар США', 'USD', 1, 2.4752, 2.4752, '2020-04-13'),
			(431, N'Доллар США', 'USD', 1, 2.4613, 2.4613, '2020-04-14'),
			(431, N'Доллар США', 'USD', 1, 2.4535, 2.4535, '2020-04-15'),
			(431, N'Доллар США', 'USD', 1, 2.4506, 2.4506, '2020-04-16'),
			(431, N'Доллар США', 'USD', 1, 2.4587, 2.4587, '2020-04-17'),
			(431, N'Доллар США', 'USD', 1, 2.445, 2.445, '2020-04-18'),
			(431, N'Доллар США', 'USD', 1, 2.445, 2.445, '2020-04-19'),
			(431, N'Доллар США', 'USD', 1, 2.445, 2.445, '2020-04-20'),
			(431, N'Доллар США', 'USD', 1, 2.4506, 2.4506, '2020-04-21'),
			(431, N'Доллар США', 'USD', 1, 2.4824, 2.4824, '2020-04-22'),
			(431, N'Доллар США', 'USD', 1, 2.4949, 2.4949, '2020-04-23'),
			(431, N'Доллар США', 'USD', 1, 2.4687, 2.4687, '2020-04-24'),
			(431, N'Доллар США', 'USD', 1, 2.463, 2.463, '2020-04-25'),
			(431, N'Доллар США', 'USD', 1, 2.463, 2.463, '2020-04-26'),
			(431, N'Доллар США', 'USD', 1, 2.463, 2.463, '2020-04-27'),
			(431, N'Доллар США', 'USD', 1, 2.463, 2.463, '2020-04-28'),
			(431, N'Доллар США', 'USD', 1, 2.463, 2.463, '2020-04-29'),
			(431, N'Доллар США', 'USD', 1, 2.4361, 2.4361, '2020-04-30'),
			(431, N'Доллар США', 'USD', 1, 2.4143, 2.4143, '2020-05-01'),
			(431, N'Доллар США', 'USD', 1, 2.4143, 2.4143, '2020-05-02'),
			(431, N'Доллар США', 'USD', 1, 2.4143, 2.4143, '2020-05-03'),
			(431, N'Доллар США', 'USD', 1, 2.4143, 2.4143, '2020-05-04'),
			(431, N'Доллар США', 'USD', 1, 2.4544, 2.4544, '2020-05-05'),
			(431, N'Доллар США', 'USD', 1, 2.4404, 2.4404, '2020-05-06'),
			(431, N'Доллар США', 'USD', 1, 2.4527, 2.4527, '2020-05-07'),
			(431, N'Доллар США', 'USD', 1, 2.4533, 2.4533, '2020-05-08'),
			(431, N'Доллар США', 'USD', 1, 2.4415, 2.4415, '2020-05-09'),
			(431, N'Доллар США', 'USD', 1, 2.4415, 2.4415, '2020-05-10'),
			(431, N'Доллар США', 'USD', 1, 2.4415, 2.4415, '2020-05-11'),
			(431, N'Доллар США', 'USD', 1, 2.4352, 2.4352, '2020-05-12'),
			(431, N'Доллар США', 'USD', 1, 2.4392, 2.4392, '2020-05-13'),
			(431, N'Доллар США', 'USD', 1, 2.4463, 2.4463, '2020-05-14'),
			(431, N'Доллар США', 'USD', 1, 2.4512, 2.4512, '2020-05-15'),
			(431, N'Доллар США', 'USD', 1, 2.4462, 2.4462, '2020-05-16'),
			(431, N'Доллар США', 'USD', 1, 2.4462, 2.4462, '2020-05-17'),
			(431, N'Доллар США', 'USD', 1, 2.4462, 2.4462, '2020-05-18'),
			(431, N'Доллар США', 'USD', 1, 2.4365, 2.4365, '2020-05-19'),
			(431, N'Доллар США', 'USD', 1, 2.4159, 2.4159, '2020-05-20'),
			(431, N'Доллар США', 'USD', 1, 2.4087, 2.4087, '2020-05-21'),
			(431, N'Доллар США', 'USD', 1, 2.3856, 2.3856, '2020-05-22'),
			(431, N'Доллар США', 'USD', 1, 2.3986, 2.3986, '2020-05-23'),
			(431, N'Доллар США', 'USD', 1, 2.3986, 2.3986, '2020-05-24'),
			(431, N'Доллар США', 'USD', 1, 2.3986, 2.3986, '2020-05-25'),
			(431, N'Доллар США', 'USD', 1, 2.3995, 2.3995, '2020-05-26'),
			(431, N'Доллар США', 'USD', 1, 2.402, 2.402, '2020-05-27'),
			(431, N'Доллар США', 'USD', 1, 2.409, 2.409, '2020-05-28'),
			(431, N'Доллар США', 'USD', 1, 2.4137, 2.4137, '2020-05-29'),
			(431, N'Доллар США', 'USD', 1, 2.41, 2.41, '2020-05-30'),
			(431, N'Доллар США', 'USD', 1, 2.41, 2.41, '2020-05-31'),
			(431, N'Доллар США', 'USD', 1, 2.41, 2.41, '2020-06-01'),
			(431, N'Доллар США', 'USD', 1, 2.4008, 2.4008, '2020-06-02'),
			(431, N'Доллар США', 'USD', 1, 2.3981, 2.3981, '2020-06-03'),
			(431, N'Доллар США', 'USD', 1, 2.3885, 2.3885, '2020-06-04'),
			(431, N'Доллар США', 'USD', 1, 2.3977, 2.3977, '2020-06-05'),
			(431, N'Доллар США', 'USD', 1, 2.381, 2.381, '2020-06-06'),
			(431, N'Доллар США', 'USD', 1, 2.381, 2.381, '2020-06-07'),
			(431, N'Доллар США', 'USD', 1, 2.381, 2.381, '2020-06-08'),
			(431, N'Доллар США', 'USD', 1, 2.3732, 2.3732, '2020-06-09'),
			(431, N'Доллар США', 'USD', 1, 2.3785, 2.3785, '2020-06-10'),
			(431, N'Доллар США', 'USD', 1, 2.3721, 2.3721, '2020-06-11'),
			(431, N'Доллар США', 'USD', 1, 2.3748, 2.3748, '2020-06-12'),
			(431, N'Доллар США', 'USD', 1, 2.3781, 2.3781, '2020-06-13'),
			(431, N'Доллар США', 'USD', 1, 2.3781, 2.3781, '2020-06-14'),
			(431, N'Доллар США', 'USD', 1, 2.3781, 2.3781, '2020-06-15'),
			(431, N'Доллар США', 'USD', 1, 2.3867, 2.3867, '2020-06-16'),
			(431, N'Доллар США', 'USD', 1, 2.3763, 2.3763, '2020-06-17'),
			(431, N'Доллар США', 'USD', 1, 2.3812, 2.3812, '2020-06-18'),
			(431, N'Доллар США', 'USD', 1, 2.3817, 2.3817, '2020-06-19'),
			(431, N'Доллар США', 'USD', 1, 2.3757, 2.3757, '2020-06-20'),
			(431, N'Доллар США', 'USD', 1, 2.3757, 2.3757, '2020-06-21'),
			(431, N'Доллар США', 'USD', 1, 2.3757, 2.3757, '2020-06-22'),
			(431, N'Доллар США', 'USD', 1, 2.3748, 2.3748, '2020-06-23'),
			(431, N'Доллар США', 'USD', 1, 2.3692, 2.3692, '2020-06-24'),
			(431, N'Доллар США', 'USD', 1, 2.3726, 2.3726, '2020-06-25'),
			(431, N'Доллар США', 'USD', 1, 2.3827, 2.3827, '2020-06-26'),
			(431, N'Доллар США', 'USD', 1, 2.3839, 2.3839, '2020-06-27'),
			(431, N'Доллар США', 'USD', 1, 2.3839, 2.3839, '2020-06-28'),
			(431, N'Доллар США', 'USD', 1, 2.3839, 2.3839, '2020-06-29'),
			(431, N'Доллар США', 'USD', 1, 2.4008, 2.4008, '2020-06-30'),
			(431, N'Доллар США', 'USD', 1, 2.4123, 2.4123, '2020-07-01'),
			(431, N'Доллар США', 'USD', 1, 2.4243, 2.4243, '2020-07-02'),
			(431, N'Доллар США', 'USD', 1, 2.4214, 2.4214, '2020-07-03'),
			(431, N'Доллар США', 'USD', 1, 2.4214, 2.4214, '2020-07-04'),
			(431, N'Доллар США', 'USD', 1, 2.4214, 2.4214, '2020-07-05'),
			(431, N'Доллар США', 'USD', 1, 2.4214, 2.4214, '2020-07-06'),
			(431, N'Доллар США', 'USD', 1, 2.4332, 2.4332, '2020-07-07'),
			(431, N'Доллар США', 'USD', 1, 2.444, 2.444, '2020-07-08'),
			(431, N'Доллар США', 'USD', 1, 2.4399, 2.4399, '2020-07-09'),
			(431, N'Доллар США', 'USD', 1, 2.4332, 2.4332, '2020-07-10'),
			(431, N'Доллар США', 'USD', 1, 2.43, 2.43, '2020-07-11'),
			(431, N'Доллар США', 'USD', 1, 2.43, 2.43, '2020-07-12'),
			(431, N'Доллар США', 'USD', 1, 2.43, 2.43, '2020-07-13'),
			(431, N'Доллар США', 'USD', 1, 2.4185, 2.4185, '2020-07-14'),
			(431, N'Доллар США', 'USD', 1, 2.4194, 2.4194, '2020-07-15'),
			(431, N'Доллар США', 'USD', 1, 2.4016, 2.4016, '2020-07-16'),
			(431, N'Доллар США', 'USD', 1, 2.3995, 2.3995, '2020-07-17'),
			(431, N'Доллар США', 'USD', 1, 2.3994, 2.3994, '2020-07-18'),
			(431, N'Доллар США', 'USD', 1, 2.3994, 2.3994, '2020-07-19'),
			(431, N'Доллар США', 'USD', 1, 2.3994, 2.3994, '2020-07-20'),
			(431, N'Доллар США', 'USD', 1, 2.399, 2.399, '2020-07-21'),
			(431, N'Доллар США', 'USD', 1, 2.3879, 2.3879, '2020-07-22'),
			(431, N'Доллар США', 'USD', 1, 2.3854, 2.3854, '2020-07-23'),
			(431, N'Доллар США', 'USD', 1, 2.3857, 2.3857, '2020-07-24'),
			(431, N'Доллар США', 'USD', 1, 2.3898, 2.3898, '2020-07-25'),
			(431, N'Доллар США', 'USD', 1, 2.3898, 2.3898, '2020-07-26'),
			(431, N'Доллар США', 'USD', 1, 2.3898, 2.3898, '2020-07-27'),
			(431, N'Доллар США', 'USD', 1, 2.3889, 2.3889, '2020-07-28'),
			(431, N'Доллар США', 'USD', 1, 2.4103, 2.4103, '2020-07-29'),
			(431, N'Доллар США', 'USD', 1, 2.418, 2.418, '2020-07-30'),
			(431, N'Доллар США', 'USD', 1, 2.4386, 2.4386, '2020-07-31'),
			(431, N'Доллар США', 'USD', 1, 2.4375, 2.4375, '2020-08-01'),
			(431, N'Доллар США', 'USD', 1, 2.4375, 2.4375, '2020-08-02'),
			(431, N'Доллар США', 'USD', 1, 2.4375, 2.4375, '2020-08-03'),
			(431, N'Доллар США', 'USD', 1, 2.4475, 2.4475, '2020-08-04'),
			(431, N'Доллар США', 'USD', 1, 2.4394, 2.4394, '2020-08-05'),
			(431, N'Доллар США', 'USD', 1, 2.4368, 2.4368, '2020-08-06'),
			(431, N'Доллар США', 'USD', 1, 2.4376, 2.4376, '2020-08-07'),
			(431, N'Доллар США', 'USD', 1, 2.4482, 2.4482, '2020-08-08'),
			(431, N'Доллар США', 'USD', 1, 2.4482, 2.4482, '2020-08-09'),
			(431, N'Доллар США', 'USD', 1, 2.4482, 2.4482, '2020-08-10'),
			(431, N'Доллар США', 'USD', 1, 2.4629, 2.4629, '2020-08-11'),
			(431, N'Доллар США', 'USD', 1, 2.4571, 2.4571, '2020-08-12'),
			(431, N'Доллар США', 'USD', 1, 2.4583, 2.4583, '2020-08-13'),
			(431, N'Доллар США', 'USD', 1, 2.4609, 2.4609, '2020-08-14'),
			(431, N'Доллар США', 'USD', 1, 2.4564, 2.4564, '2020-08-15'),
			(431, N'Доллар США', 'USD', 1, 2.4564, 2.4564, '2020-08-16'),
			(431, N'Доллар США', 'USD', 1, 2.4564, 2.4564, '2020-08-17'),
			(431, N'Доллар США', 'USD', 1, 2.4583, 2.4583, '2020-08-18'),
			(431, N'Доллар США', 'USD', 1, 2.4677, 2.4677, '2020-08-19'),
			(431, N'Доллар США', 'USD', 1, 2.4695, 2.4695, '2020-08-20'),
			(431, N'Доллар США', 'USD', 1, 2.4856, 2.4856, '2020-08-21'),
			(431, N'Доллар США', 'USD', 1, 2.5216, 2.5216, '2020-08-22'),
			(431, N'Доллар США', 'USD', 1, 2.5216, 2.5216, '2020-08-23'),
			(431, N'Доллар США', 'USD', 1, 2.5216, 2.5216, '2020-08-24'),
			(431, N'Доллар США', 'USD', 1, 2.5554, 2.5554, '2020-08-25'),
			(431, N'Доллар США', 'USD', 1, 2.6028, 2.6028, '2020-08-26'),
			(431, N'Доллар США', 'USD', 1, 2.6483, 2.6483, '2020-08-27'),
			(431, N'Доллар США', 'USD', 1, 2.6612, 2.6612, '2020-08-28'),
			(431, N'Доллар США', 'USD', 1, 2.6631, 2.6631, '2020-08-29'),
			(431, N'Доллар США', 'USD', 1, 2.6631, 2.6631, '2020-08-30'),
			(431, N'Доллар США', 'USD', 1, 2.6631, 2.6631, '2020-08-31'),
			(431, N'Доллар США', 'USD', 1, 2.6548, 2.6548, '2020-09-01'),
			(431, N'Доллар США', 'USD', 1, 2.6393, 2.6393, '2020-09-02'),
			(431, N'Доллар США', 'USD', 1, 2.6459, 2.6459, '2020-09-03'),
			(431, N'Доллар США', 'USD', 1, 2.6451, 2.6451, '2020-09-04'),
			(431, N'Доллар США', 'USD', 1, 2.6342, 2.6342, '2020-09-05'),
			(431, N'Доллар США', 'USD', 1, 2.6342, 2.6342, '2020-09-06'),
			(431, N'Доллар США', 'USD', 1, 2.6342, 2.6342, '2020-09-07'),
			(431, N'Доллар США', 'USD', 1, 2.6365, 2.6365, '2020-09-08'),
			(431, N'Доллар США', 'USD', 1, 2.6356, 2.6356, '2020-09-09'),
			(431, N'Доллар США', 'USD', 1, 2.6329, 2.6329, '2020-09-10'),
			(431, N'Доллар США', 'USD', 1, 2.6158, 2.6158, '2020-09-11'),
			(431, N'Доллар США', 'USD', 1, 2.5992, 2.5992, '2020-09-12'),
			(431, N'Доллар США', 'USD', 1, 2.5992, 2.5992, '2020-09-13'),
			(431, N'Доллар США', 'USD', 1, 2.5992, 2.5992, '2020-09-14'),
			(431, N'Доллар США', 'USD', 1, 2.594, 2.594, '2020-09-15'),
			(431, N'Доллар США', 'USD', 1, 2.59, 2.59, '2020-09-16'),
			(431, N'Доллар США', 'USD', 1, 2.5781, 2.5781, '2020-09-17'),
			(431, N'Доллар США', 'USD', 1, 2.5755, 2.5755, '2020-09-18'),
			(431, N'Доллар США', 'USD', 1, 2.5658, 2.5658, '2020-09-19'),
			(431, N'Доллар США', 'USD', 1, 2.5658, 2.5658, '2020-09-20'),
			(431, N'Доллар США', 'USD', 1, 2.5658, 2.5658, '2020-09-21'),
			(431, N'Доллар США', 'USD', 1, 2.5833, 2.5833, '2020-09-22'),
			(431, N'Доллар США', 'USD', 1, 2.5905, 2.5905, '2020-09-23'),
			(431, N'Доллар США', 'USD', 1, 2.5908, 2.5908, '2020-09-24'),
			(431, N'Доллар США', 'USD', 1, 2.6042, 2.6042, '2020-09-25'),
			(431, N'Доллар США', 'USD', 1, 2.5992, 2.5992, '2020-09-26'),
			(431, N'Доллар США', 'USD', 1, 2.5992, 2.5992, '2020-09-27'),
			(431, N'Доллар США', 'USD', 1, 2.5992, 2.5992, '2020-09-28'),
			(431, N'Доллар США', 'USD', 1, 2.6264, 2.6264, '2020-09-29'),
			(431, N'Доллар США', 'USD', 1, 2.6403, 2.6403, '2020-09-30'),
			(431, N'Доллар США', 'USD', 1, 2.6236, 2.6236, '2020-10-01'),
			(431, N'Доллар США', 'USD', 1, 2.6019, 2.6019, '2020-10-02'),
			(431, N'Доллар США', 'USD', 1, 2.615, 2.615, '2020-10-03'),
			(431, N'Доллар США', 'USD', 1, 2.615, 2.615, '2020-10-04'),
			(431, N'Доллар США', 'USD', 1, 2.615, 2.615, '2020-10-05'),
			(431, N'Доллар США', 'USD', 1, 2.6188, 2.6188, '2020-10-06'),
			(431, N'Доллар США', 'USD', 1, 2.6225, 2.6225, '2020-10-07'),
			(431, N'Доллар США', 'USD', 1, 2.6205, 2.6205, '2020-10-08'),
			(431, N'Доллар США', 'USD', 1, 2.613, 2.613, '2020-10-09'),
			(431, N'Доллар США', 'USD', 1, 2.578, 2.578, '2020-10-10'),
			(431, N'Доллар США', 'USD', 1, 2.578, 2.578, '2020-10-11'),
			(431, N'Доллар США', 'USD', 1, 2.578, 2.578, '2020-10-12'),
			(431, N'Доллар США', 'USD', 1, 2.57, 2.57, '2020-10-13'),
			(431, N'Доллар США', 'USD', 1, 2.5707, 2.5707, '2020-10-14'),
			(431, N'Доллар США', 'USD', 1, 2.5717, 2.5717, '2020-10-15'),
			(431, N'Доллар США', 'USD', 1, 2.576, 2.576, '2020-10-16'),
			(431, N'Доллар США', 'USD', 1, 2.5729, 2.5729, '2020-10-17'),
			(431, N'Доллар США', 'USD', 1, 2.5729, 2.5729, '2020-10-18'),
			(431, N'Доллар США', 'USD', 1, 2.5729, 2.5729, '2020-10-19'),
			(431, N'Доллар США', 'USD', 1, 2.5708, 2.5708, '2020-10-20'),
			(431, N'Доллар США', 'USD', 1, 2.5629, 2.5629, '2020-10-21'),
			(431, N'Доллар США', 'USD', 1, 2.5466, 2.5466, '2020-10-22'),
			(431, N'Доллар США', 'USD', 1, 2.546, 2.546, '2020-10-23'),
			(431, N'Доллар США', 'USD', 1, 2.5399, 2.5399, '2020-10-24'),
			(431, N'Доллар США', 'USD', 1, 2.5399, 2.5399, '2020-10-25'),
			(431, N'Доллар США', 'USD', 1, 2.5399, 2.5399, '2020-10-26'),
			(431, N'Доллар США', 'USD', 1, 2.5402, 2.5402, '2020-10-27'),
			(431, N'Доллар США', 'USD', 1, 2.5534, 2.5534, '2020-10-28'),
			(431, N'Доллар США', 'USD', 1, 2.599, 2.599, '2020-10-29'),
			(431, N'Доллар США', 'USD', 1, 2.6264, 2.6264, '2020-10-30'),
			(431, N'Доллар США', 'USD', 1, 2.6352, 2.6352, '2020-10-31'),
			(431, N'Доллар США', 'USD', 1, 2.6352, 2.6352, '2020-11-01'),
			(431, N'Доллар США', 'USD', 1, 2.6352, 2.6352, '2020-11-02'),
			(431, N'Доллар США', 'USD', 1, 2.6579, 2.6579, '2020-11-03'),
			(431, N'Доллар США', 'USD', 1, 2.6563, 2.6563, '2020-11-04'),
			(431, N'Доллар США', 'USD', 1, 2.643, 2.643, '2020-11-05'),
			(431, N'Доллар США', 'USD', 1, 2.6153, 2.6153, '2020-11-06'),
			(431, N'Доллар США', 'USD', 1, 2.578, 2.578, '2020-11-07'),
			(431, N'Доллар США', 'USD', 1, 2.578, 2.578, '2020-11-08'),
			(431, N'Доллар США', 'USD', 1, 2.578, 2.578, '2020-11-09'),
			(431, N'Доллар США', 'USD', 1, 2.577, 2.577, '2020-11-10'),
			(431, N'Доллар США', 'USD', 1, 2.5569, 2.5569, '2020-11-11'),
			(431, N'Доллар США', 'USD', 1, 2.5551, 2.5551, '2020-11-12'),
			(431, N'Доллар США', 'USD', 1, 2.568, 2.568, '2020-11-13'),
			(431, N'Доллар США', 'USD', 1, 2.5668, 2.5668, '2020-11-14'),
			(431, N'Доллар США', 'USD', 1, 2.5668, 2.5668, '2020-11-15'),
			(431, N'Доллар США', 'USD', 1, 2.5668, 2.5668, '2020-11-16'),
			(431, N'Доллар США', 'USD', 1, 2.5614, 2.5614, '2020-11-17'),
			(431, N'Доллар США', 'USD', 1, 2.5559, 2.5559, '2020-11-18'),
			(431, N'Доллар США', 'USD', 1, 2.5528, 2.5528, '2020-11-19'),
			(431, N'Доллар США', 'USD', 1, 2.5564, 2.5564, '2020-11-20'),
			(431, N'Доллар США', 'USD', 1, 2.5522, 2.5522, '2020-11-21'),
			(431, N'Доллар США', 'USD', 1, 2.5522, 2.5522, '2020-11-22'),
			(431, N'Доллар США', 'USD', 1, 2.5522, 2.5522, '2020-11-23'),
			(431, N'Доллар США', 'USD', 1, 2.5514, 2.5514, '2020-11-24'),
			(431, N'Доллар США', 'USD', 1, 2.5548, 2.5548, '2020-11-25'),
			(431, N'Доллар США', 'USD', 1, 2.56, 2.56, '2020-11-26'),
			(431, N'Доллар США', 'USD', 1, 2.567, 2.567, '2020-11-27'),
			(431, N'Доллар США', 'USD', 1, 2.5817, 2.5817, '2020-11-28'),
			(431, N'Доллар США', 'USD', 1, 2.5817, 2.5817, '2020-11-29'),
			(431, N'Доллар США', 'USD', 1, 2.5817, 2.5817, '2020-11-30'),
			(431, N'Доллар США', 'USD', 1, 2.5873, 2.5873, '2020-12-01'),
			(431, N'Доллар США', 'USD', 1, 2.5905, 2.5905, '2020-12-02'),
			(431, N'Доллар США', 'USD', 1, 2.5881, 2.5881, '2020-12-03'),
			(431, N'Доллар США', 'USD', 1, 2.5862, 2.5862, '2020-12-04'),
			(431, N'Доллар США', 'USD', 1, 2.5697, 2.5697, '2020-12-05'),
			(431, N'Доллар США', 'USD', 1, 2.5697, 2.5697, '2020-12-06'),
			(431, N'Доллар США', 'USD', 1, 2.5697, 2.5697, '2020-12-07'),
			(431, N'Доллар США', 'USD', 1, 2.5674, 2.5674, '2020-12-08'),
			(431, N'Доллар США', 'USD', 1, 2.5572, 2.5572, '2020-12-09'),
			(431, N'Доллар США', 'USD', 1, 2.5482, 2.5482, '2020-12-10'),
			(431, N'Доллар США', 'USD', 1, 2.5476, 2.5476, '2020-12-11'),
			(431, N'Доллар США', 'USD', 1, 2.5334, 2.5334, '2020-12-12'),
			(431, N'Доллар США', 'USD', 1, 2.5334, 2.5334, '2020-12-13'),
			(431, N'Доллар США', 'USD', 1, 2.5334, 2.5334, '2020-12-14'),
			(431, N'Доллар США', 'USD', 1, 2.5287, 2.5287, '2020-12-15'),
			(431, N'Доллар США', 'USD', 1, 2.53, 2.53, '2020-12-16'),
			(431, N'Доллар США', 'USD', 1, 2.5249, 2.5249, '2020-12-17'),
			(431, N'Доллар США', 'USD', 1, 2.5109, 2.5109, '2020-12-18'),
			(431, N'Доллар США', 'USD', 1, 2.5068, 2.5068, '2020-12-19'),
			(431, N'Доллар США', 'USD', 1, 2.5068, 2.5068, '2020-12-20'),
			(431, N'Доллар США', 'USD', 1, 2.5068, 2.5068, '2020-12-21'),
			(431, N'Доллар США', 'USD', 1, 2.532, 2.532, '2020-12-22'),
			(431, N'Доллар США', 'USD', 1, 2.5658, 2.5658, '2020-12-23'),
			(431, N'Доллар США', 'USD', 1, 2.5838, 2.5838, '2020-12-24'),
			(431, N'Доллар США', 'USD', 1, 2.5891, 2.5891, '2020-12-25'),
			(431, N'Доллар США', 'USD', 1, 2.5891, 2.5891, '2020-12-26'),
			(431, N'Доллар США', 'USD', 1, 2.5891, 2.5891, '2020-12-27'),
			(431, N'Доллар США', 'USD', 1, 2.5891, 2.5891, '2020-12-28'),
			(431, N'Доллар США', 'USD', 1, 2.5736, 2.5736, '2020-12-29'),
			(431, N'Доллар США', 'USD', 1, 2.5708, 2.5708, '2020-12-30'),
			(431, N'Доллар США', 'USD', 1, 2.5789, 2.5789, '2020-12-31');

     ;MERGE [HomeBudget.CurrencyRates].[dbo].[CurrencyRates] AS T
     USING @UsdRates_2020 AS S
        ON S.CurrencyId = T.CurrencyId
       AND S.UpdateDate = T.UpdateDate
  WHEN NOT MATCHED THEN
    INSERT ([CurrencyId], [Name], [Abbreviation], [Scale], [OfficialRate], [RatePerUnit], [UpdateDate]) 
    VALUES (S.[CurrencyId], S.[Name], S.[Abbreviation], S.[Scale], S.[OfficialRate], S.[RatePerUnit], S.[UpdateDate])
	  WHEN MATCHED THEN
UPDATE SET T.[OfficialRate] = S.[OfficialRate],
           T.[RatePerUnit]	= S.[RatePerUnit];
END